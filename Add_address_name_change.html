<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>CS Calendar</title>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <style>
    body { font-family: sans-serif; padding: 1rem; }
    /* ===== Login Gate ===== */
    .login-overlay { display: none; position: fixed; inset: 0; background: #f7f7f7; z-index: 2000; }
    .login-box { width: 360px; max-width: 92vw; background: #fff; border: 1px solid #ddd; border-radius: 12px; padding: 20px; box-shadow: 0 10px 30px rgba(0,0,0,.12); position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
    .login-box h2 { margin: 0 0 10px; text-align: center; }
    .login-box label { display: block; margin-top: 10px; font-weight: 600; }
    .login-box input { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 8px; margin-top: 6px; }
    .login-actions { margin-top: 14px; display: flex; gap: 8px; }
    .login-actions button { flex: 1; padding: 10px; border: none; border-radius: 8px; cursor: pointer; }
    .btn-primary { background: #1976d2; color: #fff; }
    .btn-secondary { background: #bbb; color: #000; }
    .login-note { font-size: 12px; color: #666; margin-top: 8px; text-align: center; }

    /* ===== Existing styles (unchanged) ===== */
    .calendar-wrapper { overflow-y: auto; max-height: 80vh; scroll-behavior: smooth;}
    #calendar-table td.weekend { background: #fff1f1 !important; }
    #calendar-table td.weekend.sat { background: #f3ecff !important; }
    thead th.holiday { background: #ffd9d9 !important; color: #333; }
    #calendar-table td.holiday-col { background: #ffd9d9 !important; }
    table { border-collapse: collapse; width: max-content; }
    th, td { border: 1px solid #ccc; padding: 6px; width: 120px; height: 80px; text-align: left; vertical-align: top; background: white; cursor: pointer; }
    thead th { position: sticky; top: 0; font-size: 2.1em; text-align: center; vertical-align: middle; }
    td:first-child, th:first-child { position: sticky; left: 0; background: #f1f1f1; font-weight: bold;}
    #calendar-table td:first-child { font-size: clamp(20px, 2vw, 40px);}    
    .event { font-size: 0.85rem; padding: 2px; display: block; }
    .Warranty { background: #72d572; }
    .Service { background: #2a36b1; color: white; }
    .Standby { background: #009688; color: white; }
    .LTC { background: #795548; color: white; }
    .Training { background: #cddc39; color: black; }
    .Inspection { background: #00bcd4; color: white; }
    .TrainingSafety { background: #259b24; color: white; }
    .Telephone { background: #ab47bc; color: white; }
    .Meeting { background: #212121; color: white; }
    .RepairPP { background: #0277bd; color: white; }
    .Sales { background: #78909c; color: white; }
    .Holiday, .Leave, .SafetyHealth { background: #c41411; color: white; }
    .Other { background: #fff176; }
    .sun { background: #c41411 !important; }
    .mon { background: #fffacc !important; }
    .tue { background: #ffd1e3 !important; }
    .wed { background: #d0f0c0 !important; }
    .thu { background: #ffe0b3 !important; }
    .fri { background: #d0e6ff !important; }
    .sat { background: #e0ccff !important; }
    .overlay, .modal { display: none; }
    .overlay.active, .modal.active { display: block; }
    .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.4); z-index: 998; }
    .modal { position: fixed; top: 10%; left: 50%; transform: translateX(-50%); background: white; border: 1px solid #ccc; padding: 20px; z-index: 999; width: 300px; border-radius: 8px; max-height: 80vh; overflow-y: auto; }
    .modal h3 { margin-top: 0; text-align: center; }
    .modal label { display: block; margin-top: 10px; font-weight: bold; }
    .modal input[type="text"], .modal select { width: 100%; padding: 6px; margin-top: 4px; border: 1px solid #ccc; border-radius: 4px; }
    .modal button { margin-top: 12px; padding: 6px 12px; margin-right: 6px; border: none; border-radius: 4px; cursor: pointer; }
    .modal button:hover { opacity: 0.9; }
    .modal button:nth-child(1) { background: #4CAF50; color: white; }
    .modal button:nth-child(2) { background: #f44336; color: white; }
    .modal button:nth-child(3) { background: #bbb; }
    .selected-row td {background: #fff4b3 !important; }
    .modal-sm { position: fixed; top: 50%; left: 50%; transform: translate(-50%,-50%); background:#fff; border:1px solid #ccc; padding:16px; z-index:1000; box-shadow:0 5px 15px rgba(0,0,0,.3); width:320px; border-radius:8px; display:none; }
    .modal-sm.active { display:block; }
    .modal-sm h3 { margin:0 0 8px; text-align:center; }
    .modal-sm label { display:block; margin-top:8px; }
    .modal-sm input[type="text"], .modal-sm input[type="number"] { width:100%; padding:6px; }
    .modal-sm .row { display:flex; gap:8px; }
    .modal-sm .row > div { flex:1; }
    .modal-sm .btns { margin-top:12px; display:flex; gap:8px; }
    .modal-sm .btns button { flex:1; padding:8px; border:none; border-radius:4px; cursor:pointer; }
    .btn-save { background:#4CAF50; color:#fff; }
    .btn-del  { background:#f44336; color:#fff; }
    .btn-cancel{ background:#bbb; }
    .highlight-row { background-color: rgba(255, 215, 0, 0.4);}    
    .special-holiday,td.special-holiday {background: #fcb8d2 !important;}
    thead th.holiday { background:#f70a39 !important; color:#333; }
    #calendar-table td.holiday-col { background:#fff7d6 !important; }
    tr.selected-row td {background: #fff4b3 !important; /* ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏≠‡πà‡∏≠‡∏ô */}
  </style>
</head>
<body>
    <!-- ===== App (hidden until authenticated) ===== -->
  <div id="app" style="display:none">
    <h2>CS BKK Calendar
      <a href="https://irbeem.github.io/Cusdata/bkkbooking.html" style="display:inline-block;margin:10px 0;padding:8px 16px;background-color:#1976d2;color:#fff;text-decoration:none;border-radius:5px;font-weight:bold;">üóìÔ∏è Multiple booking</a>
      <a href="https://irbeem.github.io/Cusdata/cbicalendar.html" style="display:inline-block;margin:10px 0;padding:8px 16px;background-color:#1976d2;color:#fff;text-decoration:none;border-radius:5px;font-weight:bold;">üîÑ To CBI calendar</a>
      <button onclick="exportMonthToCSV()">üì§ Export CSV</button>
      <button id="logoutBtn" style="float:right" onclick="logout()">üö™ Logout</button>
    </h2>
          <option value="Warranty">Warranty</option>
          <option value="RepairPP">RepairPP</option>
          <option value="Sales">Sales</option>
          <option value="Holiday">Holiday</option>
          <option value="Leave">Leave</option>
          <option value="SafetyHealth">SafetyHealth</option>
          <option value="Other">Other</option>
        </select>
      </label><br>
      <label>Customer: <input type="text" id="popupCustomer"></label><br>
      <label>Time: <input type="text" id="popupTime"></label><br>
      <label>Job detail: <input type="text" id="popupDetail"></label><br>
      <label>Place: <input type="text" id="popupPlace"></label><br>
      <label>Job owner: <input type="text" id="popupJobowner"></label><br>
      <label>Charge:
        <select id="popupCharge">
          <option value="Charge">Charge</option>
          <option value="Nocharge">Nocharge</option>
          <option value="Warranty">Warranty</option>
          <option value="Sales">Sales</option>
          <option value="Other">Other</option>
        </select>
      </label><br>
      <label><input type="checkbox" id="popupSendEmail"> Send e-mail</label><br>
      <button type="button" onclick="saveData()">Save</button>
      <button type="button" onclick="deleteData()">Delete</button>
      <button type="button" onclick="closePopup()">Cancel</button>
    </div>

    <div class="modal" id="detailModal">
      <h3>Job Detail</h3>
      <div id="detailContent"></div>
      <div style="margin-top:12px;">
        <button type="button" onclick="openEditFromDetail()">Add/Delete</button>
        <button type="button" onclick="closeDetails()">Close</button>
      </div>
    </div>

    <div class="modal-sm" id="holidayModal">
      <h3>Special Holiday</h3>
      <div class="row">
        <div>
          <label>Year
            <input type="number" id="holYear" placeholder="‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á = ‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ">
          </label>
        </div>
        <div>
          <label>Month
            <input type="number" id="holMonth" min="1" max="12">
          </label>
        </div>
        <div>
          <label>Date
            <input type="number" id="holDate" min="1" max="31">
          </label>
        </div>
      </div>
      <label>Detail
        <input type="text" id="holDetail" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ß‡∏±‡∏ô‡∏ä‡∏î‡πÄ‡∏ä‡∏¢, ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©">
      </label>
      <div class="btns">
        <button class="btn-save"  onclick="saveHoliday()">Save</button>
        <button class="btn-del"   onclick="deleteHoliday()">Delete</button>
        <button class="btn-cancel" onclick="closeHoliday()">Cancel</button>
      </div>
    </div>
  </div><!-- /#app -->
<script src="config.js" defer></script>
<script type="module" src="calscript.js"></script>
</body>
</html>
